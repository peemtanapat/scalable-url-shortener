global
  stats socket /var/run/api.sock user haproxy group haproxy mode 660 level admin expose-fd listeners
  log stdout format raw local0 info

defaults
  mode http
  log global
  option httplog
  log-format "%ci:%cp -> %si:%sp [%tr] %ST %B bytes to %s"
  option dontlognull
  timeout connect 5s
  timeout client 20s
  timeout server 20s

frontend http_frontend
  bind *:8081
  default_backend redirect-api

backend redirect-api
  balance roundrobin
  option httpchk GET /api/health
  default-server inter 10s fall 3 rise 2
  server redirect-api-1 url-shortener-redirect-api-1:8080 check
  server redirect-api-2 url-shortener-redirect-api-2:8080 check
  server redirect-api-3 url-shortener-redirect-api-3:8080 check
  server redirect-api-4 url-shortener-redirect-api-4:8080 check
  server redirect-api-5 url-shortener-redirect-api-5:8080 check
  server redirect-api-6 url-shortener-redirect-api-6:8080 check
  server redirect-api-7 url-shortener-redirect-api-7:8080 check
  server redirect-api-8 url-shortener-redirect-api-8:8080 check
  server redirect-api-9 url-shortener-redirect-api-9:8080 check
  server redirect-api-10 url-shortener-redirect-api-10:8080 check
  server redirect-api-11 url-shortener-redirect-api-11:8080 check
  server redirect-api-12 url-shortener-redirect-api-12:8080 check
  server redirect-api-13 url-shortener-redirect-api-13:8080 check
  server redirect-api-14 url-shortener-redirect-api-14:8080 check
  server redirect-api-15 url-shortener-redirect-api-15:8080 check
